# Version 0.9.0_beta - 2025-10-28

**ðŸ“– [Upgrade Guide: 0.8.5_beta â†’ 0.9.0_beta](../UPGRADE_0.8.5_to_0.9.0.md)** - See full upgrade instructions including data file setup

## Added

### Chat Command Management System
Full CRUD operations for chat commands
- New `!chatCommand` command (MODERATOR required) for managing chat commands
- Subcommands: `add`, `remove`, `addMessage`, `removeMessage`, `addImage`, `removeImage`, `addAlias`, `removeAlias`
- Conflict detection: prevents creating commands/aliases that conflict with static commands or existing chat commands
- Image URL validation: supports giphy.com, tenor.com, imgur.com and other image hosting services
- Exact match deletion: only removes messages/images that match exactly what was specified
- Automatic file management: updates both `chat.json` and `aliases.json` to maintain data integrity
- Comprehensive input validation and user-friendly error messages

### Image Validation Tool
Automated maintenance and quality assurance for chat command images
- New `!imageValidator` command (MODERATOR required) for managing image validation
- Subcommands: `start`, `stop`, `status`, `report`, `remove`
- Background validation at 1 image per second with intelligent caching (30-day TTL)
- Comprehensive HTTP validation with HEAD/GET fallback for servers that don't support HEAD requests
- Retry logic with 2-attempt validation and 15-second timeout per request
- Smart re-checking: validates new images, expired cache entries, and previously dead images
- Periodic cache saving every 10 images to prevent data loss during validation
- Detailed reporting showing dead images grouped by command with status codes
- Bulk removal of confirmed dead images from chat.json
- Handles various failure scenarios: network errors, DNS failures, 403/404/405 responses
- Validates images from all supported hosting services (Giphy, Tenor, Imgur, etc.)

## Enhanced

### Improved Message Handling

#### Public Messages
- **Responsive timeout handling**: Reduced message fetch timeout from 30 seconds to 900ms to match the 1-second polling interval
- **Quick retry mechanism**: When a public message fetch times out, the next polling cycle immediately retries with the same message ID, ensuring no messages are lost

#### Private Messages
- **Optimized timeout**: Private message fetch timeout set to 5 seconds to allow for the additional overhead of querying multiple users
- **Per-user tracking**: Message tracking is maintained per user with separate `lastMessageId` and `lastTimestamp` to prevent duplicates and ensure proper message ordering

#### Concurrency Control
- **Processing flags**: `isProcessingPublicMessages` and `isProcessingPrivateMessages` flags prevent concurrent processing of the same message type
- **Safe interleaving**: Public and private message processing can occur independently without blocking each other

## Documentation

For detailed information on the new features, see:
- [Chat Commands Documentation](../CHAT_COMMANDS.md)
- [Upgrade Guide](../UPGRADE_0.8.5_to_0.9.0.md)
